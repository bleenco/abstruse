<app-header></app-header>

<div class="container">
  <div class="columns">
    <div class="column is-12">
      <div class="content">
        <div class="columns is-multiline">
          <div class="column is-12" *ngIf="build">
            <div class="build-top-container">
              <div class="columns is-multiline">
                <div class="column is-8">
                  <h2>{{ build.repository.url }}</h2>
                </div>
                <div class="column is-4 column-centered">
                  <button type="button" class="button" disabled>
                    <span class="icon">
                      <img src="images/icons/restart.svg">
                    </span>
                    Re-Start Build
                  </button>
                  <button type="button" class="button red" disabled>
                    <span class="icon">
                      <img src="images/icons/stop.svg">
                    </span>
                    Stop Build
                  </button>
                </div>
                <div class="column is-12">
                  <h3>#{{ build.id }}.{{ build.iteration }} ({{ build.uuid }})</h3>
                </div>
                <div class="column is-3">
                  <div class="label" [ngClass]="{ green: build.status === 'success', yellow: build.status === 'running', running: build.status === 'running', red: build.status === 'errored' }">
                    <span *ngIf="build.status === 'success'">
                      <span class="icon">
                        <img src="images/icons/check-icon-white.svg">
                      </span>
                      Success
                    </span>
                    <span *ngIf="build.status === 'errored'">
                      <span class="icon">
                        <img src="images/icons/check-icon-white-false.svg">
                      </span>
                      <span>Failing</span>
                    </span>
                    <span *ngIf="build.status === 'running'">
                      <span class="icon">
                        <img src="images/icons/hammer.svg">
                      </span>
                      Running
                    </span>
                    <span *ngIf="build.status === 'queue'">
                      In Queue
                    </span>
                  </div>
                </div>
                <div class="column is-9"></div>
              </div>
            </div>
          </div>

          <div class="column is-12" *ngIf="build && build.jobs && build.jobs.length">
            <div class="columns list-header">
              <div class="column is-1">Job Id</div>
              <div class="column is-4">Environment</div>
              <div class="column is-4">Script</div>
              <div class="column is-2">Status</div>
              <div class="column is-1"></div>
            </div>
            <div class="columns list-item"
                 *ngFor="let job of build.jobs; let i = index;"
                 [ngClass]="{ 'is-queued': job.status === 'queued', 'is-success': job.status === 'success', 'is-running': job.status === 'running', 'is-errored': job.status === 'failed' }">
              <div class="column is-1">
                <span># {{ build.id }}.{{ job.id }}</span>
              </div>
              <div class="column is-4">
                <div class="icon-and-text">
                  <span class="icon">
                    <img src="images/icons/linux.svg">
                  </span>
                  <span>Linux</span>
                </div>
                <div class="icon-and-text">
                  <span class="icon">
                    <img src="images/icons/code.svg">
                  </span>
                  <span *ngIf="job.language === 'node_js'">Node.js:</span>
                  <span class="version">{{ job.language_version }}</span>
                </div>
              </div>
              <div class="column is-4">
                <div class="icon-and-text">
                  <span class="icon script">
                    <img src="images/icons/computing-script.svg">
                  </span>
                  <span>{{ job.test_script }}</span>
                </div>
              </div>
              <div class="column is-2">
                <span class="status-circle" [ngClass]="{ green: job.status === 'success', yellow: job.status === 'running', red: job.status === 'failed' }"></span>
                <span>{{ job.status }}</span>
              </div>
              <div class="column is-1">
                <button type="button" class="button green" (click)="restartJob($event, job.id)" *ngIf="job.status !== 'running'" [disabled]="job.status === 'queued'">
                  Restart
                </button>
                <button type="button" class="button red" (click)="stopJob($event, job.id)" *ngIf="job.status === 'running'">
                  Stop
                </button>
              </div>
            </div>
          </div>

          <!--<div class="column is-12">
            <app-terminal [data]="terminalInput" (outputData)="terminalOutput($event)" [options]="terminalOptions"></app-terminal>
          </div>-->
        </div>
      </div>
    </div>
  </div>
</div>
